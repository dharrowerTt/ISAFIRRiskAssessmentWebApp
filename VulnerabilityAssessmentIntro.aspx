<%@ Page Title="Vulnerability Assessment" Language="VB" AutoEventWireup="false"
    MasterPageFile="~/Site.Master"
    CodeBehind="VulnerabilityAssessmentIntro.aspx.vb"
    Inherits="ISAFIRRiskAssessmentWebApp.VulnerabilityAssessmentIntro" %>

<asp:Content ID="MainContent" ContentPlaceHolderID="MainContent" runat="server">
    <div class="container mt-4">
        <h2 class="mb-3">Vulnerability Assessment</h2>

        <!-- Assessment Info -->
        <div class="mb-3">
            <strong>Assessment #:</strong> <asp:Literal ID="litAssessmentID" runat="server" /><br />
            <strong>Facility:</strong> <asp:Literal ID="litFacility" runat="server" /><br />
            <strong>Assessor:</strong> <asp:Literal ID="litAssessor" runat="server" /><br />
            <strong>Phone/Email:</strong> <asp:Literal ID="litContact" runat="server" /><br />
            <strong>Assessment Started:</strong> <asp:Literal ID="litStartDate" runat="server" />
        </div>

        <!-- Overview Instructions -->
        <div class="row mb-4">
            <div class="col-md-8">
                <p>The Vulnerability Assessment component of the Tool is an automated, survey-style questionnaire designed to measure the vulnerability of a facility to the entire scope of threats and hazards.</p>
                <ul>
                    <li>The vulnerability assessment is the most detailed portion of the I-SAFIR Risk Assessment Tool. It is organized into four sections with approximately 31 data entry screens.</li>
                    <li>The questions are based on accepted national and sector-specific standards such as ANSI, ASIS, NFPA 1600, and NIST.</li>
                    <li>The Vulnerability Score is calculated via automated tally, with each section contributing equally.</li>
                </ul>
                <p class="fw-bold">On the following screens, answer each question with a “yes”, “no” or selection of multiple-choice options.</p>
            </div>
            <div class="col-md-4">
                <img src="images/tornado-shelter.png" class="img-fluid border" alt="Tornado Shelter Sign" />
            </div>
        </div>

        <!-- Section Tiles -->
        <div class="d-flex justify-content-center flex-wrap gap-3 tile-grid">
            <div class="tile-row">
<asp:HyperLink ID="btnResilience" runat="server" CssClass="section-tile not-started" />
<asp:HyperLink ID="btnSecurity" runat="server" CssClass="section-tile not-started" />
            </div>
            <div class="tile-row">
<asp:HyperLink ID="btnDependencies" runat="server" CssClass="section-tile not-started" />
<asp:HyperLink ID="btnCyber" runat="server" CssClass="section-tile not-started" />
            </div>
            <div class="tile-row w-100 d-flex justify-content-center">
                <asp:Button ID="btnComplete" runat="server" CssClass="section-tile submit-tile" Text="Complete Facility Assessment" OnClick="btnComplete_Click" />
            </div>
        </div>

        <!-- Hidden field for assessment ID -->
        <asp:HiddenField ID="hfAssessmentID" runat="server" />
    </div>

    <style>
        .section-tile {
            width: 260px;
            height: 110px;
            font-size: 1.1rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 1rem;
            margin: 10px;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.08);
            border: none;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            cursor: pointer;
            text-decoration: none;
        }

        .section-tile:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 14px rgba(0,0,0,0.12);
        }

        .complete {
            background-color: #d4edda;
            color: #155724;
        }

        .partial {
            background-color: #fff3cd;
            color: #856404;
        }

        .not-started {
            background-color: #f8d7da;
            color: #721c24;
        }

        .submit-tile {
            background-color: #e3e8ff;
            color: #2f3e9e;
        }

        .tile-grid {
            max-width: 900px;
            margin: 0 auto;
        }

        .tile-row {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
            margin-bottom: 1rem;
        }
    </style>
</asp:Content>
