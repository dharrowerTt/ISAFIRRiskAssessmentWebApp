<%@ Page Title="Vulnerability Assessment - Section" Language="VB" AutoEventWireup="false"
    MasterPageFile="~/Site.Master"
    CodeBehind="VulnerabilitySection.aspx.vb"
    Inherits="ISAFIRRiskAssessmentWebApp.VulnerabilitySection" %>

<asp:Content ID="MainContent" ContentPlaceHolderID="MainContent" runat="server">
    <div class="container mt-4">
        <h2 class="mb-3"><asp:Literal ID="litSectionTitle" runat="server" /></h2>

        <!-- Assessment Info -->
        <div class="mb-3">
            <strong>Assessment #:</strong> <asp:Literal ID="litAssessmentID" runat="server" /><br />
            <strong>Facility:</strong> <asp:Literal ID="litFacility" runat="server" /><br />
            <strong>Assessor:</strong> <asp:Literal ID="litAssessor" runat="server" /><br />
            <strong>Phone/Email:</strong> <asp:Literal ID="litContact" runat="server" /><br />
            <strong>Assessment Started:</strong> <asp:Literal ID="litStartDate" runat="server" />
        </div>

        <!-- Question List -->
        <asp:Repeater ID="rptQuestions" runat="server">
            <ItemTemplate>
                <div class="question-block mb-4 p-3 border rounded">
                    <!-- Hidden field to store QuestionID -->
                    <asp:Label ID="lblQuestionID" runat="server" Text='<%# Eval("QuestionID") %>' Visible="false" />

                    <!-- Question -->
                    <p><strong><%# Eval("QuestionText") %></strong></p>

                    <!-- Optional Help Text -->
                    <%# If(Eval("HelpText") IsNot DBNull.Value AndAlso Eval("HelpText").ToString() <> "", "<div class='text-muted small mb-2'>" & Eval("HelpText") & "</div>", "") %>

                    <!-- Answer options -->
                    <asp:RadioButtonList ID="rblAnswer" runat="server" RepeatDirection="Horizontal" CssClass="form-check-inline">
                        <asp:ListItem Text="Yes" Value="Yes" />
                        <asp:ListItem Text="No" Value="No" />
                    </asp:RadioButtonList>
                </div>
            </ItemTemplate>
        </asp:Repeater>

        <!-- Save button and hidden assessment ID -->
        <asp:Button ID="btnSave" runat="server" CssClass="btn btn-primary" Text="Save Responses" OnClick="btnSave_Click" />
        <asp:HiddenField ID="hfAssessmentID" runat="server" />
    </div>
</asp:Content>
